import { html } from "amp/lib";
import { dashboard, recaptcha } from "config";

export const body = html`
  <main class="wrapper">
    <amp-layout layout="intrinsic" width="320" height="320" style="margin:auto">
      <svg
        width="87"
        height="22"
        viewBox="0 0 875 220"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M640.35 86.42C634.457 86.42 629.82 88.8467 626.44 93.7C623.06 98.5533 621.37 105.313 621.37 113.98C621.37 122.733 623.06 129.407 626.44 134C629.82 138.507 634.933 140.76 641.78 140.76C645.853 140.76 649.797 140.197 653.61 139.07C657.51 137.943 661.41 136.557 665.31 134.91V156.1C661.237 157.92 657.033 159.22 652.7 160C648.453 160.867 643.903 161.3 639.05 161.3C628.997 161.3 620.763 159.307 614.35 155.32C607.937 151.333 603.213 145.787 600.18 138.68C597.147 131.487 595.63 123.21 595.63 113.85C595.63 104.49 597.363 96.2133 600.83 89.02C604.297 81.8267 609.367 76.1933 616.04 72.12C622.8 67.96 630.99 65.88 640.61 65.88C645.117 65.88 649.84 66.4 654.78 67.44C659.72 68.48 664.573 70.1267 669.34 72.38L661.67 92.14C658.29 90.4933 654.867 89.15 651.4 88.11C647.933 86.9833 644.25 86.42 640.35 86.42ZM723.864 160L704.884 93.18H704.364C704.537 94.9133 704.71 97.2533 704.884 100.2C705.057 103.147 705.23 106.353 705.404 109.82C705.577 113.2 705.664 116.493 705.664 119.7V160H683.434V67.18H716.844L736.214 133.09H736.734L755.714 67.18H789.124V160H766.114V119.31C766.114 116.363 766.157 113.243 766.244 109.95C766.33 106.57 766.46 103.407 766.634 100.46C766.807 97.4267 766.937 95.0433 767.024 93.31H766.504L747.784 160H723.864ZM869.827 131.79C869.827 136.817 868.527 141.583 865.927 146.09C863.414 150.597 859.471 154.28 854.097 157.14C848.811 159.913 841.921 161.3 833.427 161.3C829.181 161.3 825.454 161.083 822.247 160.65C819.127 160.303 816.181 159.697 813.407 158.83C810.634 157.963 807.774 156.837 804.827 155.45V133.09C809.854 135.603 814.924 137.553 820.037 138.94C825.151 140.24 829.787 140.89 833.947 140.89C837.674 140.89 840.404 140.24 842.137 138.94C843.871 137.64 844.737 135.993 844.737 134C844.737 131.573 843.437 129.623 840.837 128.15C838.324 126.59 834.034 124.467 827.967 121.78C823.374 119.613 819.387 117.36 816.007 115.02C812.627 112.593 810.027 109.647 808.207 106.18C806.387 102.713 805.477 98.3367 805.477 93.05C805.477 87.07 806.951 82.0867 809.897 78.1C812.844 74.0267 816.917 70.9933 822.117 69C827.404 66.92 833.514 65.88 840.447 65.88C846.514 65.88 851.974 66.5733 856.827 67.96C861.681 69.26 866.014 70.7767 869.827 72.51L862.157 91.88C858.171 90.06 854.227 88.63 850.327 87.59C846.514 86.4633 842.961 85.9 839.667 85.9C836.461 85.9 834.077 86.4633 832.517 87.59C831.044 88.7167 830.307 90.1467 830.307 91.88C830.307 93.3533 830.871 94.6533 831.997 95.78C833.124 96.9067 834.987 98.1633 837.587 99.55C840.274 100.85 843.914 102.54 848.507 104.62C853.014 106.613 856.827 108.823 859.947 111.25C863.154 113.59 865.581 116.407 867.227 119.7C868.961 122.907 869.827 126.937 869.827 131.79Z"
          fill="url(#paint0_linear)"
        />
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M0 110C0 170.751 49.2494 220 110 220C170.754 220 220 170.751 220 110C220 49.2494 170.754 0 110 0C49.2494 0 0 49.2494 0 110Z"
          fill="white"
        />
        <path
          d="M101.573 176.718H93.2128L101.478 126.68L75.8817 126.717C75.8817 126.717 75.6403 126.723 75.5242 126.723C73.2203 126.723 71.3503 124.853 71.3503 122.549C71.3503 121.559 72.2731 119.885 72.2731 119.885L118.265 43.1811L126.766 43.2147L118.293 93.3319L144.021 93.3014C144.021 93.3014 144.299 93.2953 144.43 93.2953C146.734 93.2953 148.601 95.1622 148.601 97.4692C148.601 98.4042 148.237 99.2261 147.715 99.9228L101.573 176.718ZM110 0C49.2494 0 0 49.2494 0 110C0 170.751 49.2494 220 110 220C170.754 220 220 170.751 220 110C220 49.2494 170.754 0 110 0Z"
          fill="#005AF0"
        />
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M358.937 144.305H323.957L318.149 161.333H294.389L328.577 68.6693H354.581L388.769 161.333H364.745L358.937 144.305ZM353.129 127.145L341.513 92.8253L329.765 127.145H353.129ZM502.421 68.6693V161.333H479.849V103.385L459.785 161.333H440.249L420.053 103.253V161.333H397.481V68.6693H425.069L450.281 133.217L474.965 68.6693H502.421ZM540.569 128.597V161.333H517.997V68.0093H554.561C565.65 68.0093 574.097 70.7593 579.905 76.2593C585.713 81.7594 588.617 89.1733 588.617 98.5013C588.617 104.309 587.319 109.479 584.723 114.011C582.127 118.543 578.277 122.107 573.173 124.703C568.069 127.299 561.865 128.597 554.561 128.597H540.569ZM552.053 110.513C561.117 110.513 565.649 106.509 565.649 98.5013C565.649 90.3173 561.117 86.2253 552.053 86.2253H540.569V110.513H552.053Z"
          fill="#005AF0"
        />
        <defs>
          <linearGradient
            id="paint0_linear"
            x1="589"
            y1="40"
            x2="875"
            y2="180"
            gradientUnits="userSpaceOnUse"
          >
            <stop stop-color="#FF52E1" />
            <stop offset="1" stop-color="#5500D7" />
          </linearGradient>
        </defs>
      </svg>

      <amp-layout amp-access="NOT canAccessDashboard" amp-access-hide>
        <form method="post" action-xhr="/_api/login" target="_top">
          <fieldset>
            <label>
              <span>Email:</span>
              <input type="email" name="email" required autocomplete="email" />
            </label>
            <br />
            <label>
              <span>Password:</span>
              <input
                type="password"
                name="password"
                required
                autocomplete="current-password"
              />
            </label>
            ${recaptcha.siteKey &&
            html`<amp-recaptcha-input
              layout="nodisplay"
              name="reCAPTCHA_body_key"
              data-sitekey="${recaptcha.siteKey}"
              data-action="reCAPTCHA_admin_login"
            >
            </amp-recaptcha-input>`}
            <br />
            <input type="submit" value="Login" />
          </fieldset>
          <div class="result">
            <div submit-success class="success">
              <template type="amp-mustache">
                {{#canAccessDashboard}}
                <div>
                  <a
                    href="${dashboard.path}"
                    class="button"
                    style="border-radius:4px;"
                    >Access dashboard</a
                  >
                </div>
                {{/canAccessDashboard}} {{^canAccessDashboard}} You shall not
                pass! üßê {{/canAccessDashboard}}
              </template>
            </div>
            <div submit-error class="error">
              <template type="amp-mustache">
                Incorrect email or password
              </template>
            </div>
          </div>
        </form>
      </amp-layout>
    </amp-layout>
  </main>
`;
export const head = html`
  <title>AMP CMS</title>
  <script
    async
    custom-element="amp-form"
    src="https://cdn.ampproject.org/v0/amp-form-0.1.js"
  ></script>
  <script
    async
    custom-template="amp-mustache"
    src="https://cdn.ampproject.org/v0/amp-mustache-0.2.js"
  ></script>
  <script
    async
    custom-element="amp-access"
    src="https://cdn.ampproject.org/v0/amp-access-0.1.js"
  ></script>
  ${recaptcha.siteKey &&
  html`<script
    async
    custom-element="amp-recaptcha-input"
    src="https://cdn.ampproject.org/v0/amp-recaptcha-input-0.1.js"
  ></script>`}

  <script id="amp-access" type="application/json">
    {
      "authorization": "/_api/access?rid=READER_ID&url=SOURCE_URL",
      "pingback": "/_api/ping?rid=READER_ID&url=SOURCE_URL",
      "login": "/_api/login?rid=READER_ID&url=SOURCE_URL",
      "authorizationFallbackResponse": { "error": true }
    }
  </script>
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link
    href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&display=swap"
    rel="stylesheet"
  />

  <style amp-custom>
    body {
      font-size: 16px;
      line-height: 1.2;
      font-family: "Noto Sans", sans-serif;
      color: #3e464c;
      background: #f2f2f2;
    }
    .wrapper {
      width: 100vw;
      height: 100vh;
      padding: 2rem;
      box-sizing: border-box;
      display: flex;
    }
    fieldset {
      background: white;
      padding: 1rem;
      margin-top: 0.5rem;
      border-radius: 8px;
      border: none;
      box-shadow: 0 3px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
    }
    label {
      display: flex;
      flex-direction: column;
      text-transform: uppercase;
      font-weight: bold;
      font-size: 0.8rem;
      line-height: 1.5rem;
    }
    input {
      padding: 0.5rem;
      border: 1px solid rgba(0, 0, 0, 0.12);
    }
    button,
    .button,
    input[type="submit"] {
      background: #5500d7
        linear-gradient(99.67deg, #5500d7 -6.01%, #ff52e1 104.46%);
      color: white;
      border: none;
      padding: 1rem 2rem;
      text-transform: uppercase;
      font-weight: bold;
      display: inline-block;
      text-decoration: none;
    }
    input[type="submit"] {
      width: 100%;
      box-shadow: 0 3px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
    }
    .result {
      margin-top: 1rem;
      text-align: center;
    }
    .error {
      color: #f44336;
    }

    form.amp-form-submit-success fieldset {
      display: none;
    }
  </style>
`;
